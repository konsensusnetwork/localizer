# Capitolo 20: **La creazione di una moneta senza stato**

Nel 1984, l'economista e premio Nobel Friedrich Hayek dichiarò in un'intervista:

> Non credo che avremo mai più una buona moneta finché non la toglieremo dalle mani del governo. Dato che non possiamo strappargliela con la violenza, l'unica cosa che possiamo fare è introdurre, in modo scaltro e indiretto, qualcosa che non siano in grado di fermare.[^307]

A prima vista, un'affermazione del genere può sembrare estrema. Tuttavia, se consideriamo che al mondo esistono circa 160 valute e che la maggior parte di queste perde rapidamente valore e gode di scarsa accettazione al di fuori della propria area di monopolio, allora l'affermazione suona subito meno radicale.

Nella storia moderna, governo e moneta sono spesso andati di pari passo ma, proprio come accade per governo e religione, non è detto che debbano essere intrinsecamente legati. E anche qualora lo fossero, ciò non esclude l'esistenza di alternative private. In molti paesi in via di sviluppo, la gente ricorre abitualmente al dollaro o all'oro alla ricerca di un po' di stabilità, invece di affidarsi completamente alle proprie instabili valute locali.

Per decenni, nel corso degli anni ottanta, novanta e duemila, i programmatori hanno cercato di creare una moneta digitale non statale attraverso la crittografia su internet, ottenendo un successo temporaneo di varia entità che si è però sempre concluso con un fallimento o una fase di stallo. Hanno, tuttavia, gettato le basi per ciò che sarebbe venuto dopo.[^308]

Nel 1982, l'informatico e crittografo David Chaum ha discusso la sua tesi di dottorato a Berkeley, dal titolo *'Computer Systems Established, Maintained, and Trusted by Mutually Suspicious Groups'.*[^309] La tesi illustrava come diverse entità, diffidenti le une verso le altre, potessero gestire insieme un database condiviso ricorrendo a tecniche crittografiche. Nel 1983 ha inventato l'e-cash, che sfruttava una tecnica crittografica da lui sviluppata, nota come 'firme cieche', per rendere possibili transazioni elettroniche private in cui persino le parti incaricate dell'elaborazione non potevano vedere i dettagli, ma erano comunque in grado di processarle grazie a prove matematiche.[^310] Nel 1989 ha fondato la società DigiCash per sfruttare commercialmente questa opportunità. L'iniziativa, tuttavia, non ebbe successo; l'adozione da parte di esercenti e utenti fu limitata e non riuscì a innescare un effetto rete in grado di autoalimentarsi. Nel 1998 DigiCash è fallita e nel 1999, in un articolo di *Forbes*, Chaum ha dichiarato: 'È stato difficile convincere abbastanza esercenti ad accettarlo, in modo da avere abbastanza consumatori disposti a usarlo, o viceversa'.[^311] Ha inoltre osservato che la privacy nelle transazioni non era una priorità, a fronte di un numero sempre maggiore di persone che si connettevano a internet e di un conseguente calo del livello medio di competenza degli utenti.

Nel 1989 fu sviluppato l'Hypertext Transfer Protocol (HTTP). Chi legge conosce bene i vari codici di errore associati a questo protocollo, e il più famoso di tutti è 'HTTP 404 Not Found'. Ci siamo imbattuti tutti, prima o poi, in questo messaggio: è l'errore che compare quando si tenta di visitare una pagina web inesistente, spesso a causa di un errore di battitura o perché la pagina è stata rimossa. Pochi sanno, invece, che un altro dei codici di errore originali è 'HTTP 402 Payment Required'. Fin dalla sua creazione, il codice di errore 402 fu messo da parte per usi futuri, in previsione di una qualche forma di moneta digitale. Per decenni rimase quasi del tutto inutilizzato, persino nell'era dell'e-commerce, poiché i pagamenti online erano ancora, in ultima analisi, gestiti dalle banche tramite un'interfaccia su internet, invece di essere nativamente digitali.

Nel 1996, la Gold and Silver Reserve Inc. (G&SR) lanciò e-gold, un servizio che permetteva agli utenti di aprire un conto online sul proprio sito web, con saldi denominati in grammi d'oro. Gli utenti potevano trasferire valore istantaneamente ad altri conti, anche per frazioni di grammo. Al suo apice, il servizio contava oltre 5 milioni di conti e un volume di trasferimenti annui pari a 2 miliardi di dollari. Tuttavia, a partire dagli anni duemila, la società iniziò ad avere problemi legali. Dopo gli attacchi terroristici dell'11 settembre, il governo federale statunitense approvò il Patriot Act, che, tra le altre misure, inasprì la regolamentazione per le società di trasferimento di denaro. Il governo federale intentò una causa contro l'azienda e, nel 2009, le sue attività furono interrotte.[^312] Questo episodio evidenzia il problema dell'oro che ho descritto in precedenza nel libro: per circolare rapidamente, l'oro deve essere gestito in forma astratta da un depositario centrale, e tale entità può essere corrotta o chiusa.

Tra la fine degli anni novanta e l'inizio degli anni duemila, furono compiuti diversi passi avanti sul fronte della scarsità digitale. Nel 1997 Adam Back creò Hashcash, un sistema di proof-of-work (prova di lavoro) pensato per limitare lo spam via e-mail e gli attacchi *denial-of-service*. L'idea alla base della proof-of-work è quella di utilizzare tecniche che richiedono una notevole potenza di calcolo per produrre una sorta di gettone o certificato digitale, la cui autenticità può essere poi facilmente verificata da chiunque lo riceva. In seguito, Nick Szabo propose Bit Gold, che si basava sull'idea di sfruttare questo 'costo infalsificabile' per creare un bene scarso online. Hal Finney, a sua volta, integrò sia Hashcash sia l'idea di Bit Gold in un'invenzione del 2004 chiamata Reusable Proof of Work (RPOW). Utilizzando un server centralizzato, Finney trasformò Hashcash in un gettone riutilizzabile, una sorta di oggetto da collezione digitale la cui scarsità era verificabile, che chiamò gettoni RPOW.[^313] All'epoca circolavano anche altre proposte di valuta digitale, ma il percorso di sviluppo tracciato da Back, Szabo e Finney si rivelò particolarmente importante.

Il limite che accomunava la maggior parte di questi progetti monetari era la loro centralizzazione. DigiCash, in quanto società centralizzata, non riuscì a creare un effetto rete. E-gold ebbe un notevole successo, finché non fu fatto chiudere dal governo. I gettoni RPOW facevano affidamento su un server centralizzato.

Nel 2008, uno sviluppatore o un gruppo di sviluppatori dall'identità sconosciuta, usando lo pseudonimo di Satoshi Nakamoto, applicò alcune di queste tecniche in modo decentralizzato. Il 31 ottobre 2008, Satoshi presentò un articolo intitolato "Bitcoin: A Peer-to-Peer Electronic Cash System" in una mailing list dedicata alla crittografia, a cui erano iscritte diverse delle persone sopracitate, insieme a molte altre.

L'abstract recitava:

> Una versione puramente peer-to-peer di denaro elettronico permetterebbe di inviare pagamenti online direttamente da una parte all'altra senza passare per un'istituzione finanziaria. Le firme digitali forniscono parte della soluzione, ma i principali vantaggi vengono meno se per impedire la doppia spesa è ancora necessaria una terza parte fidata. Proponiamo una soluzione al problema della doppia spesa utilizzando una rete peer-to-peer. La rete appone una marca temporale alle transazioni, inserendole tramite hashing in una catena di prove di lavoro, formando così un registro che non può essere modificato senza rieseguire la prova di lavoro. La catena più lunga non serve solo come prova della sequenza di eventi registrati, ma anche come dimostrazione del fatto che proviene dal più grande bacino di potenza di calcolo (CPU). Finché la maggioranza della potenza di calcolo sarà controllata da nodi che non collaborano per attaccare la rete, questi genereranno la catena più lunga e supereranno in velocità gli aggressori. La rete stessa richiede una struttura minima. I messaggi vengono trasmessi secondo il principio del 'best effort', e i nodi possono lasciare la rete e riconnettersi a piacimento, accettando la catena di prova di lavoro più lunga come dimostrazione di ciò che è accaduto durante la loro assenza.[^314]

L'articolo, di sole nove pagine, era scritto in stile accademico e conteneva otto citazioni relative a diverse tecniche di crittografia e di marcatura temporale, inclusa una per l'Hashcash di Adam Back. Nelle settimane successive, diversi crittografi iscritti alla mailing list esaminarono l'articolo ponendo domande, perlopiù con un approccio critico e scettico, a cui Satoshi rispose sempre con cortesia.[^315] Queste e-mail sono ora di dominio pubblico e scorrerle dà l'impressione di assistere alla discussione di una tesi di dottorato, con un botta e risposta fra professionisti fatto di domande puntuali e di risposte altrettanto precise.

In nessun momento Satoshi ha promesso ricchezza né ha mai assunto i toni del venditore. Scriveva come un accademico, sebbene avesse chiarito che l'obiettivo del suo lavoro era la libertà, in linea con l'etica del movimento cypherpunk.

Una persona sulla mailing list, per esempio, ha scritto: 'Non troverete una soluzione ai problemi politici nella crittografia'. Satoshi rispose: 'Sì, ma possiamo vincere una battaglia importante nella corsa agli armamenti e conquistare un nuovo territorio di libertà per diversi anni. I governi sono bravi a tagliare la testa a network controllati centralmente come Napster, ma i network puramente P2P come Gnutella e Tor sembrano tenere duro'.[^316]

Satoshi ha poi rilasciato il codice open source il 9 gennaio 2009, ed ha estratto la prima serie di blocchi. Nel blocco genesi, ha inserito un riferimento al titolo di un quotidiano dell'epoca sui salvataggi delle banche britanniche nel pieno della crisi finanziaria globale:

> The Times 03/Jan/2009 Chancellor on brink of second bailout for banks[^317]

Hal Finney ha annunciato pubblicamente in un tweet, il 10 gennaio, di aver avviato il software di Bitcoin e ha poi ricevuto la prima transazione di prova da Satoshi.[^318]

Nei primi due anni di vita di Bitcoin, tra il 2009 e il 2010, Satoshi ha continuato a fornire aggiornamenti per il codice e a discutere vari concetti con i primi utenti, mantenendo il suo tono pacato e fattuale. Alla fine del 2010, Satoshi è scomparso e non ha più pubblicato nulla, lasciando il progetto nelle mani di altri.[^319] Al momento in cui scrivo, nessuno è riuscito a dimostrare con certezza la sua identità. Da allora si è assistito a un ricambio continuo di sviluppatori per la rete Bitcoin.

Bitcoin è un registro pubblico distribuito che alcuni hanno definito 'partita contabile a tripla registrazione'. È un protocollo che permette a tutti i partecipanti nel mondo di raggiungere un consenso sullo stato del registro, in media, ogni dieci minuti. Chiunque abbia un computer portatile e una connessione a internet può partecipare alla rete come operatore di un nodo, eseguendo un'applicazione software gratuita e a codice sorgente aperto; questo permette di inviare e ricevere transazioni senza l'autorizzazione di alcuna entità centralizzata. Per l'elaborazione di nuovi blocchi di transazioni sulla rete (ovvero aggiornamenti del registro), i minatori ricevono le commissioni di transazione e i bitcoin di nuova creazione, utilizzando la proof-of-work e la marcatura temporale. Gli operatori dei nodi verificano che i nuovi blocchi di transazioni rispettino le regole della rete. Poiché il registro è ampiamente distribuito e relativamente piccolo in termini di dati, gli operatori dei nodi possono conservare una copia completa del registro e sincronizzarla costantemente con il resto della rete. Gli utenti possono conservare le proprie chiavi private che, insieme alle applicazioni dei nodi, permettono loro di spostare monete (o frazioni di monete, tipicamente chiamate 'sats', abbreviazione di 'satoshis') dal proprio indirizzo a quello di qualcun altro sul registro, senza ricorrere a un depositario terzo. In alternativa, si può scegliere di affidare le proprie chiavi a un depositario, interagendo così con bitcoin in modo simile a un conto bancario. Il numero totale di bitcoin che esisterà è di 21 milioni, e sono divisibili in un totale di 2,1 biliardi di sats.

Si tratta di un concetto incredibilmente potente. Chi possiede bitcoin può memorizzare dodici parole (che rappresentano la sua chiave privata) e portare con sé i propri risparmi ovunque nel mondo, senza fare affidamento su una controparte centralizzata. Bitcoin è un registro decentralizzato, che esiste in tutto il mondo su un cloud decentralizzato di computer, costoso da attaccare e le cui regole sono impossibili da modificare unilateralmente. Non esiste un server centrale né un emittente centrale. È completamente trasparente, il che significa che ogni riga di codice è pubblica. Gli sviluppatori possono collaborare per creare e proporre aggiornamenti, ma non c'è modo di imporli agli utenti; gli aggiornamenti possono solo essere accettati liberamente e devono essere retrocompatibili, se si vuole rimanere parte della rete esistente.

Inoltre, Bitcoin colma il divario di velocità tra transazioni e regolamenti che ho descritto più volte in questo libro. Dall'invenzione e dalla diffusione dei sistemi di telecomunicazione intercontinentali nella seconda metà del XIX secolo, le transazioni hanno potuto viaggiare per il mondo alla velocità della luce, mentre la moneta, sotto forma di bene al portatore scarso e auto-custodito (come l'oro), poteva essere trasportata e verificata solo alla velocità della materia. Questo divario di velocità ha aperto un'enorme opportunità di arbitraggio che banche e governi hanno potuto sfruttare, concedendo loro il monopolio sulla custodia del denaro per i pagamenti veloci a lunga distanza. Bitcoin rappresenta il primo modo significativo per regolare il valore di un bene scarso alla velocità della luce: una volta che i bitcoin vengono inviati sulla rete e confermati da alcuni blocchi sulla blockchain, diventano irreversibili --- a meno che oltre il 50% dei minatori della rete (sparsi in tutto il mondo) tenti di annullare la transazione. Un bitcoin è un bene scarso che non rappresenta la passività di terzi, proprio come un lingotto d'oro, e questa capacità di spostare rapidamente un bene non riconducibile a una passività su lunghe distanze è qualcosa che il mondo non ha mai conosciuto prima.

Nel capitolo 8 ho parlato della descrizione di una camera di compensazione mondiale centralizzata fatta da William Stanley Jevons nel 1875, che avrebbe permesso a tutte le entità di regolare le transazioni tra loro rapidamente. E sebbene la sua visione si sia progressivamente concretizzata, prima con centro a Londra e poi a New York, il problema era che questa camera di compensazione mondiale centralizzata si basava sull'astrazione e sul debito, permettendo così una notevole mala gestione del registro. Bitcoin può fungere da camera di compensazione mondiale *de*centralizzata, perché anziché basarsi sull'astrazione e sul debito, i beni al portatore stessi possono essere regolati direttamente tra le entità in pochi minuti.[^320]

Non è un caso che, da quando è diventato possibile effettuare transazioni alla velocità della luce, ci sia voluto circa un secolo e mezzo perché anche la liquidazione degli asset al portatore potesse avvenire alla stessa velocità. Si è trattato di un processo dipendente dal percorso, simile al modo in cui l'invenzione della bicicletta, in una qualche sua forma, doveva necessariamente precedere quella dell'automobile. Le transazioni basate sul credito tramite sistemi di telecomunicazione richiedevano solo dati semplici per avvenire, come il codice Morse, e quindi potevano essere eseguite già nel XIX secolo. La liquidazione di valore scarso su sistemi di telecomunicazione, invece, richiede una potenza di calcolo, strutture di dati, larghezza di banda e prove matematiche molto più complesse. Bitcoin, insieme alle idee più ampie di scarsità digitale e di una rete di liquidazione decentralizzata, è stato inventato quasi non appena è stato tecnologicamente possibile, in base ai tempi di sviluppo delle tecnologie sottostanti su cui si basa.

Se dovessi descrivere in un paragrafo perché il denaro è stato *rotto* in tutto il mondo per così tanto tempo, mentre quasi ogni altro settore è migliorato in modo sostanziale (abbondanza di energia, di tecnologia e così via), direi che è a causa del divario tra la velocità delle transazioni e quella delle liquidazioni, creato dall'era delle telecomunicazioni. Per un secolo e mezzo, il mondo è rimasto bloccato in un massimo locale che ha richiesto e incentivato forme sempre più complesse di astrazione centralizzata per colmare questo divario. Il gold standard internazionale ha funzionato per diversi decenni in tempo di pace, ma era intrinsecamente viziato fin dall'inizio, a causa dell'enorme quantità di crediti che permetteva su una base monetaria di oro fisico così ridotta, e infatti è crollato alla sua prima vera prova, non appena è scoppiata la guerra tra le grandi potenze europee. Il sistema di Bretton Woods era ancora più difettoso, a causa di livelli di astrazione ancora maggiori, ed è riuscito a fallire in meno di quindici anni dalla sua piena attuazione. Il sistema moderno, con 160 diverse valute fiat in costante svalutazione e vagamente ancorate a una valuta fiat di riserva mondiale, è estremamente fragile perché privo di qualsiasi fondamento intrinseco di scarsità. L'invenzione di Bitcoin come rete di liquidazione rapida e open source, con le sue unità scarse, offre il primo modo credibile per colmare quel divario tra velocità di transazione e di liquidazione. Ora si tratta di studiarlo e metterlo alla prova per vedere se è abbastanza solido da servire a questo scopo su larga scala e a lungo termine.

**Una panoramica della tecnologia di bitcoin**

Satoshi ha sintetizzato bitcoin in un post su un forum nel febbraio 2009, circa un mese dopo il suo lancio. Da allora sono stati scritti migliaia di articoli e molti libri su bitcoin, ma penso che la descrizione di Satoshi stesso resti un riferimento utile per la sua chiarezza:

> Ho sviluppato un nuovo sistema di denaro elettronico P2P open source chiamato Bitcoin. È completamente decentralizzato, senza server centrali o entità fidate, perché tutto si basa sulla prova crittografica anziché sulla fiducia. Provatelo, o date un'occhiata agli screenshot e al documento di progetto:
>
> Scaricate Bitcoin v0.1 su <http://www.bitcoin.org>
>
> Il problema di fondo della valuta convenzionale è tutta la fiducia necessaria per farla funzionare. Bisogna fidarsi che la banca centrale non svaluti la moneta, ma la storia delle valute fiat è piena di episodi in cui tale fiducia è stata tradita. Bisogna fidarsi delle banche perché custodiscano i nostri soldi e li trasferiscano elettronicamente, ma queste li prestano generando ondate di bolle creditizie, con a malapena una frazione a riserva. Dobbiamo affidare loro la nostra privacy, fidandoci che non permettano a ladri d'identità di prosciugare i nostri conti. I loro enormi costi di gestione rendono impossibili i micropagamenti.
>
> Una generazione fa, i sistemi informatici multiutente a ripartizione di tempo avevano un problema simile. Prima della crittografia forte, gli utenti dovevano affidarsi alla protezione tramite password per mettere al sicuro i propri file, riponendo fiducia nell'amministratore di sistema affinché mantenesse private le loro informazioni. La privacy poteva sempre essere annullata dall'amministratore in base a una sua valutazione discrezionale, soppesando il principio della privacy rispetto ad altre esigenze, o su ordine dei suoi superiori. Poi la crittografia forte è diventata disponibile per tutti e la fiducia non è più stata necessaria. I dati potevano essere protetti in un modo che fosse fisicamente impossibile per chiunque altro consultarli, a prescindere dal motivo, dalla bontà della scusa o da qualsiasi altra cosa.
>
> È ora di avere la stessa cosa per il denaro. Con una moneta elettronica basata sulla prova crittografica, senza la necessità di fidarsi di un intermediario di terze parti, il denaro può essere sicuro e le transazioni agevoli.
>
> Uno degli elementi costitutivi fondamentali di un sistema del genere sono le firme digitali. Una moneta digitale contiene la chiave pubblica del suo proprietario. Per trasferirla, il proprietario firma la moneta insieme alla chiave pubblica del nuovo proprietario. Chiunque può verificare le firme per controllare la catena di proprietà. Questo sistema funziona bene per garantire la proprietà, ma lascia un grosso problema irrisolto: la doppia spesa. Qualsiasi proprietario potrebbe tentare di spendere di nuovo una moneta già spesa, firmandola a favore di un altro proprietario. La soluzione tipica è affidarsi a un'azienda fidata con un database centrale che verifichi l'assenza di doppie spese, ma questo non fa che riportarci al modello basato sulla fiducia. Dalla sua posizione centrale, l'azienda può prevaricare sugli utenti e le commissioni necessarie per sostenerla rendono i micropagamenti antieconomici.
>
> La soluzione di Bitcoin è usare una rete peer-to-peer per verificare l'assenza di doppie spese. In sintesi, la rete funziona come un server di marcatura temporale distribuito, marcando temporalmente la prima transazione con cui si spende una moneta. Sfrutta il fatto che l'informazione è facile da propagare, ma difficile da reprimere. Per maggiori dettagli sul suo funzionamento, consultate il documento di progetto su <http://www.bitcoin.org/bitcoin.pdf>
>
> Il risultato è un sistema distribuito senza un singolo punto di fallimento. Gli utenti detengono le chiavi crittografiche del proprio denaro ed effettuano transazioni direttamente tra loro, con il supporto della rete P2P per verificare l'assenza di doppie spese.
>
> Satoshi Nakamoto[^321]

Alla luce di questa descrizione, i paragrafi seguenti spiegano più in dettaglio come funziona la rete Bitcoin. Non è necessario che i lettori comprendano ogni singolo aspetto, e i dettagli più profondi sono ancora più complessi, ma è utile analizzare i dettagli di livello intermedio; farò del mio meglio per usare un linguaggio semplice. In questo libro uso la maiuscola per la parola 'Bitcoin' quando mi riferisco alla rete e la lascio minuscola quando mi riferisco a 'bitcoin' l'unità monetaria (a meno che, ovviamente, non sia la prima parola di una frase).

La storia di Bitcoin inizia con un blocco genesi e un'applicazione software open source scaricabile, creata da Satoshi, che chiunque può usare per gestire il proprio nodo sulla rete. Il blocco genesi e tutti i blocchi successivi presentano un enigma crittografico (che in sostanza è un numero enorme nascosto) risolvibile solo indovinando ripetutamente la risposta tramite la potenza di calcolo (un processo comunemente chiamato *mining*, ma che forse sarebbe più corretto definire *timestamping* o marcatura temporale). Chiunque può contribuire con la potenza di calcolo del proprio computer per tentare di risolvere questo enigma, anche se in pratica oggi si usano esclusivamente processori specializzati SHA-256 per via della loro efficienza. Chi trova la soluzione all'enigma può collegare un nuovo blocco (pieno di transazioni) a quello precedente e viene ricompensato con le commissioni di transazione e un certo numero di nuove monete, il che incentiva gli utenti a dedicare la propria potenza di calcolo a questo fine. Questo nuovo blocco crea anche un nuovo enigma per proseguire il processo e creare il blocco successivo.

La rete Bitcoin usa la crittografia a chiave pubblica. Un utente genera casualmente una chiave privata, che è semplicemente un numero enorme. È possibile generare una chiave lanciando una moneta 256 volte, per esempio, ma in pratica la maggior parte delle persone usa software 'wallet' per farsene generare una. Il numero di chiavi private possibili è superiore a quello degli atomi presenti in un milione di galassie, quindi la probabilità di generarne una a caso o di indovinarne una già generata da qualcun altro è infinitesimale.[^322] In una forma più comprensibile per l'uomo, la chiave privata può essere salvata o memorizzata come una 'frase seme' di dodici parole. La chiave privata può essere usata per creare una chiave pubblica e un indirizzo, a cui altri utenti possono inviare bitcoin. La chiave pubblica e l'indirizzo derivano dalla chiave privata, ma il processo non è reversibile; nessuno può risalire alla chiave privata partendo dalla chiave pubblica o dall'indirizzo. La chiave privata, nota solo all'utente, permette di firmare una transazione per inviare bitcoin (incluse frazioni di bitcoin) dal proprio indirizzo a quello di qualcun altro.

Quando il proprietario di una chiave privata avvia e firma una transazione, questa transazione in sospeso (il movimento di bitcoin dal proprio indirizzo a quello di un altro utente, o persino da più indirizzi propri a più indirizzi di altre persone) viene propagata alla rete degli altri nodi. Ogni nodo gestisce una coda di transazioni in attesa chiamata 'mempool' (abbreviazione di 'memory pool'). Ogni nodo conserva anche la cronologia completa di tutti i blocchi e delle relative transazioni a partire dal blocco genesi. Pertanto, ogni nodo contiene il registro completo e tutta la sua cronologia fin dalla sua creazione. Un *miner* (o un *pool* di *miner*) che risolve con successo l'enigma lasciato dal blocco precedente può esaminare la propria coda di transazioni in sospeso e selezionarne alcune da aggiungere al nuovo blocco che crea. Ogni blocco può contenere qualche migliaio di transazioni, a seconda della loro complessità. I mittenti di una transazione devono includere una commissione per il *miner* insieme alla loro transazione in sospeso. Se nella coda ci sono più transazioni in sospeso di quante ne possa contenere il blocco, un *miner* di solito inserisce nel blocco le transazioni con le commissioni più alte per massimizzare i propri guadagni. Nei momenti di grande traffico sulla rete, le transazioni con commissioni più alte vengono generalmente inserite in un blocco più in fretta rispetto a quelle con commissioni più basse. I *miner* che creano un blocco con successo vengono ricompensati dalla rete con un sussidio per il blocco (*block subsidy*, ovvero un certo numero di nuove monete create per ogni blocco), oltre alle commissioni di tutte le transazioni che includono nel blocco.

Una volta creato, il *miner* invia il nuovo blocco alla rete dei nodi, i quali verificano che rispetti le regole della rete, come la quantità massima di dati che può contenere ogni blocco e il numero massimo di nuove monete (il sussidio per il blocco) che il *miner* può creare per sé. Se un nodo stabilisce che un blocco è valido, lo archivia e lo propaga agli altri nodi; in breve tempo, tutti i nodi verificano e archiviano questo nuovo blocco. La cronologia completa di tutti i blocchi e delle loro transazioni è comunemente nota come 'blockchain', ed è archiviata su ogni nodo. Esistono decine di migliaia di nodi in tutto il mondo, ciascuno dei quali archivia il registro completo, incluse tutte le transazioni a partire dal blocco genesi.

Figura 20-A

Se due minatori risolvono l'ultimo enigma quasi contemporaneamente, si crea una biforcazione temporanea della catena. Alcuni nodi vedranno prima il ‘blocco A’ del minatore A, altri vedranno prima il ‘blocco B’ del minatore B e li invieranno ai rispettivi nodi della rete. Alcuni minatori potrebbero iniziare a risolvere l'enigma lasciato dal ‘blocco A’ e altri quello lasciato dal ‘blocco B’, a seconda di quale blocco viene loro propagato per primo. Alla fine, un minatore ne risolve uno, poniamo quello del ‘blocco B’, e questa diventa la blockchain più lunga rispetto a quella che termina con il ‘blocco A’. Quando questa informazione si propaga nella rete, quella diventa la nuova blockchain dominante, il ‘blocco A’ viene scartato come blocco orfano e la biforcazione della catena si risolve di nuovo in un unico registro contabile condiviso. I nodi sono programmati per considerare la catena più lunga, che rispetti le regole della rete, come quella valida su cui continuare a costruire.

La finalizzazione di ogni transazione in bitcoin è probabilistica, ma in pratica una transazione viene considerata sempre più ‘definitiva’ man mano che viene coperta da un numero crescente di blocchi, poiché richiederebbe una mole di lavoro sempre maggiore per creare una serie di blocchi, basata su un blocco precedente, che sia più lunga della catena attuale. Una transazione contenuta in un solo blocco corre un certo rischio di essere annullata, se dovesse emergere da qualche parte nella rete una catena quasi simultanea ma più lunga. Per una transazione confermata da due o tre blocchi, è molto meno probabile che ciò accada. Una transazione confermata da sei o più blocchi è quasi certo che non verrà mai annullata. Queste cifre potrebbero cambiare in futuro in caso di tentativi di attacchi di censura o di doppia spesa sulla rete da parte di attaccanti con ingenti capitali, costringendo gli utenti ad attendere più a lungo per la conferma delle proprie transazioni. Più una transazione è grande e importante, più diventa importante attendere che diversi blocchi vengano aggiunti dopo quello che la contiene.

La rete controlla la velocità con cui vengono aggiunti nuovi blocchi alla blockchain, con l'obiettivo di aggiungerne uno nuovo in media ogni dieci minuti. Se alla rete si aggiunge più potenza di calcolo che inizia a tentare di risolvere l'enigma per estrarre bitcoin, l'aggiunta di blocchi accelererà. Se parte della potenza di calcolo abbandona la rete, la creazione dei blocchi rallenterà. Ogni 2.016 blocchi (circa due settimane), la rete verifica la velocità media di creazione dei nuovi blocchi e regola la difficoltà dell'enigma del mining per riportare l'intervallo medio tra i blocchi a dieci minuti. In questo modo, indipendentemente da quanta potenza di calcolo si unisca o abbandoni la rete, la rete continua a produrre in media un blocco ogni dieci minuti.

Più nodi ci sono sulla rete, più decentralizzata è l'applicazione delle sue regole e, di conseguenza, più resistente è a modifiche indesiderate. Più potenza di calcolo è presente sulla rete, più diventa costoso per un'entità ostile attaccarla annullando di proposito le transazioni precedenti o censurando quelle nuove. Qualora un'entità o un gruppo di entità riuscisse a raggiungere e mantenere oltre il 50% della potenza di calcolo della rete (un'impresa che attualmente richiede attrezzature ed elettricità per un valore di miliardi di dollari), avrebbe la capacità di censurare la rete a proprio piacimento, ma non potrebbe comunque modificare le regole imposte dagli operatori dei nodi che la gestiscono. Gli utenti della rete potrebbero rispondere a questo attacco mettendo in campo più potenza di calcolo per provare a riconquistare la maggioranza del 50% di partecipanti onesti e porre fine alla censura.

Gli sviluppatori di tutto il mondo possono proporre aggiornamenti al software dei nodi Bitcoin, quello che gli utenti installano per gestire un nodo. Un team a rotazione di maintainer volontari organizza, revisiona e pubblica gli aggiornamenti, che gli operatori dei nodi possono poi valutare e decidere se installare o meno. Gli sviluppatori non hanno modo di obbligare gli operatori dei nodi a effettuare un aggiornamento. Al momento in cui scriviamo, esiste un'implementazione principale del software per nodi Bitcoin, nota come Bitcoin Core. Tuttavia, esistono altre implementazioni sviluppate da persone diverse, compatibili tra loro e con Bitcoin Core. Poiché il codice è open source, è possibile effettuare un ‘fork’ dell'implementazione dominante di Bitcoin Core e percorrere un'altra strada, qualora gli operatori dei nodi del sistema ritenessero che gli sviluppatori associati a quell'implementazione non agiscano più nel loro interesse.

Un ‘aggiornamento del client’ comporta piccole modifiche a Bitcoin Core o ad altre applicazioni client di Bitcoin. Dato che i sistemi operativi evolvono nel tempo, è necessario mantenere il software client compatibile con essi. Questo tipo di aggiornamento non modifica le regole di consenso della rete, ma si limita per lo più ad aggiornare altre parti del software per rendere la gestione di un nodo più semplice e sicura.

Una ‘soft fork’ è una modifica retrocompatibile alle regole di consenso della rete; ciò significa che i nodi che installano questo software possono continuare a interagire sulla stessa rete con i nodi più vecchi non ancora aggiornati. Nello specifico, una soft fork restringe leggermente l'insieme delle regole di consenso esistenti. Un esempio di soft fork è la riduzione della dimensione massima del blocco: infatti, qualsiasi blocco creato dopo questo aggiornamento rispetterebbe le regole precedenti sulla dimensione massima, ma le nuove regole sarebbero leggermente più restrittive. Storicamente, Bitcoin è stato aggiornato tramite soft fork, che hanno ottimizzato il codice e aggiunto alcune nuove funzionalità. Facendo un'analogia, i dispositivi USB 2.0 sono compatibili con le porte USB 1.0 esistenti, ma offrono nuove funzioni a chi decide di passare alle porte USB 2.0. Allo stesso modo, i dispositivi USB 3.0 sono compatibili con le porte USB 2.0 (e precedenti), ma offrono un ulteriore livello di funzionalità.

Una ‘hard fork’ è una modifica non retrocompatibile alle regole di consenso della rete; ciò significa che qualsiasi nodo che si aggiorni a questo software utilizza un insieme di regole non più compatibile con il resto della rete. Un esempio è l'aumento del limite di dimensione del blocco; infatti i blocchi prodotti con questo software supererebbero il limite di dimensione massima previsto dalle regole dei nodi più vecchi e verrebbero quindi rifiutati dalla rete. Altri esempi di hard fork sono l'aumento del numero di bitcoin nel sistema o l'incremento del ritmo futuro di creazione di nuovi bitcoin per blocco. I nodi esistenti rifiuterebbero automaticamente i blocchi con queste caratteristiche. Facendo un'analogia, è come introdurre un protocollo di comunicazione diverso e incompatibile con lo standard USB, che non funzionerebbe con le porte USB esistenti.

Un aggiornamento incompatibile, ovvero un ‘hard fork’, crea una rete separata del libro mastro, con un numero di nodi e una potenza di calcolo molto inferiori e non viene riconosciuta come Bitcoin dalla rete di nodi esistente (a meno che la stragrande maggioranza dei singoli nodi e minatori non decida collettivamente di passare al nuovo insieme di regole incompatibili). Quando si verifica un hard fork, il libro mastro viene di fatto copiato e ogni detentore di chiave privata conserva i propri bitcoin sul registro esistente e, in aggiunta, ha accesso a un numero equivalente di monete derivate dal fork sul nuovo libro mastro. Da quel momento, l'esito degli hard fork è determinato dalle forze di mercato: ogni detentore possiede ora entrambe le serie di monete, anche se è probabile che il fork minoritario abbia un valore di mercato considerevolmente inferiore. La cronologia di tutte le transazioni precedenti al fork è la stessa per i due libri mastri ma, a partire dal punto in cui si verifica la biforcazione, i registri possono iniziare a divergere a causa delle nuove diverse transazioni che vengono aggiunte a ciascuno di essi. Se un utente è fortemente convinto di quale fork prevarrà, potrebbe vendere le monete dell'altro e acquistare più monete associate al fork che ritiene vincente. Se un utente non ha un'opinione precisa, potrebbe conservare entrambe le serie di monete e attendere che il fork si risolva e che il valore del fork minoritario venga riassorbito nella rete principale. Ci sono stati molti hard fork dalla rete principale di Bitcoin e, al momento della stesura di questo libro, il più grande ha solo circa lo 0,5% della capitalizzazione di mercato della rete Bitcoin principale. Il fork preesistente è quello già compatibile con la rete di nodi esistente, il che gli conferisce un vantaggio intrinseco nel prevalere sulle competizioni con nuovi hard fork incompatibili.

Bitcoin è stato programmato da Satoshi per produrre in media 50 nuove monete ogni dieci minuti, assegnate al minatore che crea un blocco valido; ogni 210.000 blocchi (circa ogni quattro anni) il numero di nuove monete prodotte ogni dieci minuti viene dimezzato. Dopo quattro anni, si è passati a 25 monete ogni dieci minuti, quattro anni dopo a 12,5, e quattro anni dopo ancora a 6,25, e così via. Questa riduzione della ricompensa per il blocco è stata programmata nel software fin dall'inizio. Il risultato matematico è che la rete si avvicina asintoticamente a 21 milioni di monete, con quasi 19,5 milioni già create al momento della stesura di questo libro.



Figura 20-B[^323]

Anche se all'inizio alcuni di questi concetti possono sembrare complicati, non sono neanche lontanamente complessi come i dettagli del funzionamento del sistema bancario globale, comprese le complesse interazioni che avvengono tra le entità finanziarie per elaborare le transazioni in dollari e gli accordi di credito overnight tra istituti finanziari tramite i contratti pronti contro termine in dollari e altri accordi simili. Il livello di base della rete Bitcoin è molto più semplice al confronto e la maggior parte dei suoi meccanismi è trasparente per gli utenti. Il fatto che un nodo completo possa funzionare su un computer portatile datato testimonia la sua semplicità di base; la rete Bitcoin è solo uno sciame di questi nodi relativamente semplici, programmati per interagire tra loro e raggiungere un consenso sullo stato del libro mastro ogni dieci minuti. I dettagli qui descritti, tuttavia, sono importanti per i potenziali primi utilizzatori che cercano di stabilire se questa rete abbia probabilità di successo o cosa questo tipo di tecnologia possa significare per il concetto di denaro in futuro.

Oggi esistono molti tipi di dispositivi per la firma e app portafoglio per smartphone che consentono agli utenti di gestire facilmente chiavi private, indirizzi e funzioni del nodo senza doversi preoccupare di cosa succede 'sotto il cofano', un po' come il proprietario di un'automobile non ha bisogno di essere un meccanico. Questi prodotti sono creati da vari team e aziende in tutto il mondo; chiunque può creare nuovi prodotti e servizi per gli utenti, a patto che siano compatibili con la rete open-source di Bitcoin.

Esiste un'ampia gamma di livelli di coinvolgimento tecnico che gli utenti possono scegliere di avere quando interagiscono con la rete Bitcoin. Chi gestisce il proprio nodo e detiene le proprie chiavi private può verificare l'offerta della rete, partecipare al suo consenso, avviare transazioni peer-to-peer e tutelare la propria privacy, il tutto senza interazioni con terze parti centralizzate. A meno che qualcuno non ottenga il controllo di oltre la metà della potenza di calcolo dell'intera rete (o si presenti alla sua porta con la forza), nessuno può impedire a un operatore di nodo di inviare o ricevere transazioni. È possibile utilizzare varie tecniche di privacy e anonimizzazione ed eseguire direttamente software associato anche ad altri livelli della rete.

Un'alternativa consiste nel conservare le proprie chiavi private, affidandosi però a un nodo gestito da terzi. Questa soluzione sacrifica un po' di privacy e verificabilità, ma permette almeno di custodire le proprie monete, con la possibilità di iniziare a gestire un proprio nodo in qualsiasi momento. Si tratta di una via di mezzo che offre alle persone una notevole flessibilità per aumentare il proprio coinvolgimento nel tempo.

Scendendo ancora di un gradino, si può utilizzare un servizio di custodia per detenere le proprie chiavi private. Esistono app portafoglio e società di servizi finanziari che offrono servizi di custodia, detenendo bitcoin per i clienti e permettendo loro di inviarli facilmente. Questo metodo è molto comodo, ma introduce problemi di privacy e il rischio di controparte, il che include la potenziale impossibilità di prelevare le proprie monete o di inviarle a un indirizzo di propria scelta. Esistono alcune nuove tecnologie, come il protocollo open-source Fedimint, che consentono modalità di custodia automatizzate e private.

Esistono anche soluzioni ibride, grazie alla tecnologia multifirma. La firma digitale richiesta per inviare bitcoin da un indirizzo può essere suddivisa in più parti, in cui, ad esempio, sono necessarie due firme su tre per autorizzare una transazione. Questo è utile per avere maggiore sicurezza o per la pianificazione successoria. Si può, ad esempio, tenere una chiave con sé, conservarne una seconda in un luogo separato e sicuro (magari affidandola a un parente di fiducia, a un rappresentante legale o salvandola in un file crittografato e protetto da password) e affidare la terza a una società di servizi finanziari specializzata in bitcoin. Questo meccanismo offre una certa protezione in caso di smarrimento di una delle chiavi e garantisce all'utente alcuni dei vantaggi di un servizio di custodia, senza però cedere al custode il pieno controllo delle proprie monete. Questo tipo di custodia ibrida è impossibile con il contante, l'oro e altre forme di denaro non crittografato.

Concludiamo il capitolo con una domanda: 'chi controlla il libro mastro di Bitcoin?'.

In primo luogo, sono le decine di migliaia di utenti che gestiscono i nodi a controllare il libro mastro; chiunque possieda un comune computer portatile (o un hardware simile) e una connessione a internet può partecipare come operatore di un nodo. Sono gli operatori dei nodi a conservare l'intera cronologia del libro mastro e a gestire collettivamente il software su cui si basa la rete, garantendo il rispetto delle sue regole per i nuovi blocchi aggiunti alla blockchain dai miner.

In secondo luogo, i miner svolgono un ruolo fondamentale nell'aggiornamento del libro mastro. I miner utilizzano elettricità e processori specializzati per guadagnarsi il diritto di aggiungere nuove transazioni al libro mastro. Un singolo miner o un gruppo di miner che riesca a raggruppare più del 50% di tutta la potenza di calcolo attiva sulla rete potrebbe censurare o annullare transazioni recenti che gli utenti consideravano definitive. Potrebbero censurare transazioni specifiche oppure attaccare la rete estraendo blocchi vuoti, così da bloccare tutte le transazioni future. Se questo dovesse accadere, non si tratterebbe necessariamente di un problema permanente; gli utenti del sistema potrebbero mettere in rete ulteriore potenza di calcolo, incentivati dall'aumento delle commissioni pagate dagli utenti censurati, per riconquistare collettivamente più del 50% della potenza di calcolo della rete.

Gli sviluppatori hanno una certa influenza ma nessun potere diretto sul libro mastro, poiché non possono obbligare un operatore di nodo ad accettare un aggiornamento del software. Se gli sviluppatori propongono un aggiornamento sgradito agli operatori, questi ultimi semplicemente non lo accetteranno. In tal caso, gli operatori continueranno a usare il software di cui già dispongono e potrebbero, alla fine, decidere di supportare altri sviluppatori per la creazione di aggiornamenti diversi. Molti operatori di nodi, prima di adottare un aggiornamento, aspettano anche anni dalla sua pubblicazione, per assicurarsi che sia del tutto stabile e privo di errori. Naturalmente, gli sviluppatori restano importanti per la rete; la loro competenza nel creare aggiornamenti retrocompatibili, desiderati dagli utenti, ha contribuito a rendere Bitcoin più sicuro e scalabile nel tempo. Il gruppo degli sviluppatori è composto da un insieme di volontari in continua evoluzione (molti dei quali ricevono sostegno economico da aziende dell'ecosistema) e garantisce che il software dei nodi resti compatibile con gli ambienti informatici moderni, anch'essi in costante mutamento.

A differenza delle banche, delle banche centrali e dei sistemi finanziari basati sulla valuta fiat, non esiste alcuna entità in grado di svalutare unilateralmente il libro mastro di Bitcoin. Non esiste un nodo centrale che possa creare un milione di nuovi bitcoin per sé. Nessuno può sottrarre i bitcoin di un utente, a meno che non si impossessi della sua chiave privata (che può essere ulteriormente protetta da password e/o da una firma multipla) o non lo costringa a cederli. Il libro mastro è trasparente, oggettivo e garantito da risorse del mondo reale, ossia elettricità e processori specializzati.

## Note



[^307]: James Blanchard, *An Interview with F.A. Hayek*, 1° maggio 1984.

[^308]: Aaron van Wirdum, *The Genesis Book*, capp. 6-13.

[^309]: David Chaum, *Computer Systems Established, Maintained and Trusted by Mutually Suspicious Groups*.

[^310]: Chaum, «Blind Signatures for Untraceable Payments».

[^311]: Julie Pitta, «Requiem for a Bright Idea», *Forbes*, 1° novembre 1999.

[^312]: Kim Zetter, «Bullion and Bandits», *Wired*, 9 giugno 2009.

[^313]: van Wirdum, *The Genesis Book*, capp. 10-11 e cap. 13.

[^314]: Nakamoto, «Bitcoin».

[^315]: Nakamoto, *Emails*.

[^316]: Nakamoto, *Bitcoin: P2P E-Cash Paper*.

[^317]: Mempool.space, *Genesis: 0*.

[^318]: Hal Finney, *Running bitcoin*, *Twitter*, 10 gennaio 2009; Mempool.space, *Block: 170*.

[^319]: Pete Rizzo, *The Last Days of Satoshi*, *Bitcoin Magazine*, 26 aprile 2021.

[^320]: Graham Krizek, 'Every Company Will Be a Lightning Company', *Medium*, 21 giugno 2023.

[^321]: Satoshi Nakamoto, 'Bitcoin Open Source Implementation of P2P Currency'.

[^322]: Yan Pritzker, *Inventing Bitcoin: The Technology Behind the First Truly Scarce and Decentralized Money Explained*, 50--53; Matt Cutler, 'Guessing a Private Key', Blocknative, 26 giugno 2019.

[^323]: Blockchain.com, 'Total Circulating Bitcoin'.